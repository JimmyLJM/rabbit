env:
  global:
    - DISPLAY=":99.0"
notifications:
  webhooks:
    - https://webhook.commit-email.info/
rvm:
  - 2.3.7
  - 2.4.4
  - 2.5.1
addons:
  apt:
    packages:
      - dbus-x11
#      - python-blockdiag
      - python-pip
matrix:
  allow_failures:
    - rvm: ruby-head
  fast_finish: true
before_install:
  - gem update bundler
  - sudo -H pip install blockdiag
before_script:
  - sh -e /etc/init.d/xvfb start
script:
  - dbus-launch bundle exec rake
after_script:
  - sh -e /ext/init.d/xvfb stop
